# Поиск похожих изображений цветов
### Подход к решению
Для реализации системы поиска похожих изображений я использовала обученную на ImageNet модель ResNet50 , которая применяется для извлечения признаков (feature extraction) из изображений. Это позволяет эффективно сравнивать изображения по их визуальному содержанию, не обучая модель заново.

## Основные этапы:
### Подготовка окружения
Установлены все необходимые библиотеки: torch, torchvision, scikit-learn, Pillow, numpy.

### Загрузка и подготовка данных
Взята папка с изображениями цветов (flowers/), из которой были собраны пути ко всем изображениям. Использовались только файлы с расширениями .jpg, .jpeg, .png.

### Обработка изображений
Все изображения приведены к размеру 224x224 пикселей и нормализованы по каналам, как того требует модель ResNet50.

### Извлечение признаков
Модель ResNet50 используется без последнего слоя, таким образом она выдает 2048-мерный вектор признаков для каждого изображения.

### Сохранение эмбеддингов и путей
Полученные вектора сохранены в файл models/resnet_features.npy, а соответствующие им пути, в models/image_paths.pkl.

### Построение модели поиска соседей
Обучена модель NearestNeighbors с метрикой косинусного расстояния, чтобы находить самые похожие изображения.

### Docker-контейнер
Создан Dockerfile для сборки образа.Веса модели добавлены внутрь контейнера. Добавлены зависимости и запуск через gunicorn.

### Веб-интерфейс и API
Разработано Flask-приложение с русскоязычным интерфейсом, которое поддерживает:
- загрузку изображения через веб-форму
- отображение результатов поиска
J-SON API /api/search для интеграции с другими сервисами

## С какими проблемами столкнулась и как я их решала
#### 1. Совместимость версий библиотек (самая распространенная проблема всегда).
Предупреждения о устаревших параметрах в torchvision.models.resnet50
Обновила код. 

#### 2. Контейнер зависал из-за долгой загрузки весов ResNet50
Веса модели добавлены в контейнер при сборке.

####  3. Не удалялись старые контейнеры и образы
Использованы команды sudo docker rm -f и sudo docker rmi.


## Модель ResNet50 была выбрана по следующим причинам:

Это одна из самых популярных и проверенных моделей для классификации изображений.
Она хорошо обучена на ImageNet и способна извлекать мощные семантические признаки.
Удобная структура позволяет легко убрать финальный классифицирующий слой и использовать её как feature extractor.

Размер выходного вектора 2048 чисел это оптимальный компромисс между точностью и скоростью работы. Широко используется в задачах поиска похожих изображений, что гарантирует хорошее качество результатов.

####  Как я поняла, что модель работает хорошо
Результаты поиска визуально корректны.
При запуске тестового поиска через search_similar() и отображении результатов видно, что найденные изображения действительно похожи на исходное.
Высокое значение similarity у похожих изображений.
Значения для похожих изображений часто выше 0.9, что говорит о высоком уровне совпадения признаков.
Стабильность модели.
Модель стабильно работает как в интерфейсе, так и через API, без падений и ошибок.
Быстрый поиск.
Поиск по базе из тысяч изображений занимает доли секунды благодаря эффективности NearestNeighbors.


#### Что можно улучшить
Если продолжать развивать проект:
Добавить больше данных, чтобы можно было искать и похожие на другие цветы.
Можно попробовать другие модели использовать (например, EfficientNet, ViT).
Добавить кэширование результатов поиска.
Сделать интерфейс адаптивным под мобильные устройства

#### Заключение
Поиск наиболее похожих растений на основе входного изображения реализован успешно. Я создала систему поиска похожих изображений цветов на основе ResNet50, научила модель искать похожие изображения, разработала веб-интерфейс и JSON API, собрала всё в Docker-контейнер. Это готовое решение, которое можно использовать как в быту, так и внедрять в более крупные продукты.
